# Tasks: ui-overhaul

[This file is generated by /sdd:tasks and tracks implementation progress]

## Task T001: Establish Material UI Foundation
**Status:** Completed
**Dependencies:** None
**Files:**
- `package.json`
- `app/layout.tsx`
- `app/globals.css`
- `app/theme.ts`

### Description
Install Material UI and MUI Icons, configure a light theme provider, and replace ad-hoc inline styles with baseline typography and CSS reset support.

### Acceptance Criteria
- `@mui/material`, `@mui/icons-material`, and emotion peer deps installed with lockfile updated
- Theme provider wraps the app in `app/layout.tsx` with white background baseline
- Global typography uses Material UI defaults without conflicting legacy styles

### Implementation Notes
- Follow AGENTS.md styling guidance (Prettier, 100-char lines)
- Reference spec Overview for Material UI requirement
- Add Jest config stubs if required by new dependencies

---

## Task T002: Scaffold Minimalist Canvas Layout
**Status:** Completed
**Dependencies:** T001
**Files:**
- `app/page.tsx`
- `app/chat-client.tsx`
- `app/chat-client.module.css`

### Description
Restructure the main page into a predominantly white canvas with a reserved content area and right-aligned control rail placeholder consistent with success metrics.

### Acceptance Criteria
- Main layout renders a spacious white canvas leaving central area open for future modules
- Control rail container fixed to right edge with vertical alignment support on desktop and responsive fallback on mobile
- Component snapshot tests added via Jest + React Testing Library to verify layout structure

### Implementation Notes
- Keep layout accessible with proper landmarks
- Reference spec Story 2 expectations for unobtrusive interface

---

## Task T003: Implement Connection Toggle Control
**Status:** Pending
**Dependencies:** T002
**Files:**
- `app/chat-client.tsx`
- `app/components/SessionControls.tsx`
- `tests/chat/session-controls.test.tsx`

### Description
Create a SessionControls component using MUI icons that toggles between connect and disconnect states, triggers existing session logic, and surfaces inline success/error feedback.

### Acceptance Criteria
- Single icon button swaps between `Connect` and `Disconnect` states with distinct Material icons
- Clicking connect/disconnect reuses existing handlers and updates status within 1s for success paths
- Inline snackbar/toast appears for error states without shifting layout; unit tests cover state transitions and error display

### Implementation Notes
- Reference spec Story 1
- Wrap fetch errors with user-friendly messaging per AGENTS.md error handling guidance

---

## Task T004: Add Microphone Toggle Functionality
**Status:** Pending
**Dependencies:** T003
**Files:**
- `app/chat-client.tsx`
- `app/components/SessionControls.tsx`
- `tests/chat/mic-toggle.test.tsx`

### Description
Introduce a mute/unmute Material UI icon control that pauses outgoing microphone capture while leaving the session active, honoring real-time constraints even during AI playback.

### Acceptance Criteria
- Control visibly reflects mute state with dedicated iconography and tooltip labels
- Muting halts audio stream within 250ms and unmuting resumes without reconnecting
- Jest tests simulate mute/unmute events ensuring handlers fire during mocked playback state

### Implementation Notes
- Reference spec Story 3
- Ensure accessibility via `aria-pressed`

---

## Task T005: Integrate Voice Activity Meter
**Status:** Pending
**Dependencies:** T003
**Files:**
- `app/components/VoiceMeter.tsx`
- `app/chat-client.tsx`
- `tests/chat/voice-meter.test.tsx`

### Description
Render a bottom-right Material UI indicator visualizing AI voice activity using realtime audio level data with graceful fallback when metrics are unavailable.

### Acceptance Criteria
- Voice meter component animates during agent playback and rests when idle
- Component positions bottom-right without overlapping transcript drawer or controls
- Unit tests validate state mapping for active/inactive scenarios with mocked data

### Implementation Notes
- Reference spec Story 2
- Consider CSS animations or MUI progress components for dynamic feedback

---

## Task T006: Capture Live Transcript State
**Status:** Pending
**Dependencies:** T003
**Files:**
- `app/chat-client.tsx`
- `app/lib/transcript-store.ts`
- `tests/chat/transcript-store.test.tsx`

### Description
Subscribe to realtime session events to maintain an in-memory transcript and support sending text messages through the existing pipeline.

### Acceptance Criteria
- Transcript store records conversation entries in chronological order for the current session
- Text message submissions post to the realtime agent and update transcript on confirmation
- Unit tests confirm ordering, message submission, and reset on disconnect

### Implementation Notes
- Reference spec Story 4 acceptance criteria
- Guard against session null states per AGENTS.md error handling rules

---

## Task T007: Build Transcript Drawer UI
**Status:** Pending
**Dependencies:** T006
**Files:**
- `app/components/TranscriptDrawer.tsx`
- `app/chat-client.tsx`
- `tests/chat/transcript-drawer.test.tsx`

### Description
Create a Material UI drawer that slides from the right, occupies â‰¤30% width, applies translucent styling, and exposes transcript history plus text input.

### Acceptance Criteria
- Drawer toggles via control rail icon and respects width/opacity limits across breakpoints
- Transcript list shows newest entries without manual scroll; text input sends through transcript store
- Component tests validate open/close behavior and message submission flow

### Implementation Notes
- Reference spec Story 4
- Ensure escape key and focus management meet accessibility expectations

---

## Task T008: Author End-to-End Scenario
**Status:** Pending
**Dependencies:** T004, T005, T007
**Files:**
- `tests/e2e/ui-overhaul.spec.ts`
- `playwright.config.ts`

### Description
Create a Playwright test covering connect, mute/unmute, transcript drawer, and voice meter visibility to confirm critical flows operate together.

### Acceptance Criteria
- Playwright suite spins up Next.js dev server fixture and exercises connect/mute/drawer interactions
- Assertions cover icon state changes, drawer animation, and voice meter presence
- Test documented in README or AGENTS.md follow-up note for running Playwright alongside Jest

### Implementation Notes
- Reference spec success metrics for coverage focus
- Reuse helper utilities for session mocking where possible

---

## Task T009: Telemetry & Support Instrumentation
**Status:** Pending
**Dependencies:** T003, T004, T006
**Files:**
- `app/chat-client.tsx`
- `app/lib/analytics.ts`
- `tests/chat/telemetry.test.tsx`

### Description
Add lightweight logging for connect success/failure, mute toggles, and drawer usage to support success metrics tracking and future tuning.

### Acceptance Criteria
- Telemetry helper records events with payloads needed to measure session completion and confusion reports
- Logging is non-blocking and disabled in test builds
- Unit tests assert event emission hooks fire on primary user actions

### Implementation Notes
- Supports spec Success Metrics and AGENTS.md observability note
- Keep implementation toggleable for production vs development

---

## Task T010: Accessibility & Responsiveness Review
**Status:** Pending
**Dependencies:** T007
**Files:**
- `app/chat-client.tsx`
- `app/components/*`
- `tests/chat/accessibility.test.tsx`

### Description
Validate keyboard navigation, aria labeling, and responsive breakpoints for the new interface, patching issues found.

### Acceptance Criteria
- All interactive controls reachable via keyboard with visible focus states
- Drawer, voice meter, and control icons expose descriptive labels for screen readers
- Responsive snapshots ensure control rail adapts <768px; automated accessibility test (axe or similar) passes

### Implementation Notes
- Reinforces AGENTS.md accessibility constraints (WCAG 2.1 AA)
- Include documented remediations within test assertions

---
