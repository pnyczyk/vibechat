# Tasks: ui-streamlining-and-cleanup

[This file is generated by /sdd-tasks and tracks implementation progress]

## Task T001: Expand Canvas To Full Viewport
**Status:** Completed
**Dependencies:** None
**Files:**
- `app/layout.tsx`
- `app/globals.css`
- `app/chat-client.module.css`

### Description
Stretch the chat experience to fill the browser window in both dimensions and introduce dimmable canvas states that activate while entry or disconnect overlays are visible.

### Acceptance Criteria
- Root containers use 100vw/100vh (or equivalent CSS) without introducing scrollbars on supported breakpoints
- Dimmed backdrop layer appears only during entry/disconnect states and restores to neutral on connect
- Jest + RTL layout test covers viewport fill and dimming toggles

### Implementation Notes
- Reference spec Story 1
- Verify axe accessibility after dimming overlay is applied

---

## Task T002: Rebuild Edge-Aligned Control Rail
**Status:** Pending
**Dependencies:** T001
**Files:**
- `app/components/SessionControls.tsx`
- `app/chat-client.tsx`
- `app/components/controls.module.css`

### Description
Refactor the control rail into a minimalist right-edge icon stack, remove visible labels/borders/placeholders, and keep accessibility affordances via aria attributes.

### Acceptance Criteria
- Power, mute, transcript, HAL indicator, and theme icons render vertically flush to the right viewport edge with consistent spacing
- All textual labels, frames, and placeholder panels removed from default view while aria-label/tooltips remain available for assistive tech
- Tests cover responsive alignment at ≥1024px and ≤480px and confirm aria attributes remain intact

### Implementation Notes
- Reference spec Story 2
- Coordinate with design tokens defined in theme updates from T005

---

## Task T003: Implement Lightning Entry Flow
**Status:** Pending
**Dependencies:** T001
**Files:**
- `app/chat-client.tsx`
- `app/components/EntryModal.tsx`
- `tests/chat/entry-flow.test.tsx`

### Description
Introduce a central lightning icon overlay for initial connect, dim the background, and transition into the standard control rail while wiring into realtime session creation and disconnect flow.

### Acceptance Criteria
- Initial render shows lightning icon overlay with dimmed background until connection succeeds
- Clicking lightning initiates realtime session setup and swaps to power toggle within 1s given happy-path mocks
- Disconnecting returns to entry overlay; unit/integration tests validate state machine across connect/disconnect/error paths

### Implementation Notes
- Reference spec Story 3
- Reuse existing session hooks; avoid regressions in telemetry events

---

## Task T004: Build HAL Voice Activity Indicator
**Status:** Pending
**Dependencies:** T002, T003
**Files:**
- `app/components/HalIndicator.tsx`
- `app/components/SessionControls.tsx`
- `tests/chat/hal-indicator.test.tsx`

### Description
Create a HAL 9000-inspired red glowing circle driven by voice activity metrics and integrate it into the control rail without impacting render performance.

### Acceptance Criteria
- Indicator animates glow intensity based on mocked speech/idle events while maintaining accessibility contrast
- Idle state reduces glow but remains visible for screen readers via status updates
- Performance test (Jest or profiling helper) ensures animation work stays under 4ms per frame equivalent

### Implementation Notes
- Reference spec Story 4
- Consider CSS variables or Canvas for animation; prefer lightweight approach

---

## Task T005: Add Theme Toggle With Persistence
**Status:** Pending
**Dependencies:** T002
**Files:**
- `app/theme.ts`
- `app/components/SessionControls.tsx`
- `app/lib/theme-store.ts`
- `tests/chat/theme-toggle.test.tsx`

### Description
Provide a light/dark mode switch on the control rail, ensure smooth Material UI theme transitions, and persist the chosen mode across reloads per session.

### Acceptance Criteria
- Theme toggle icon swaps between light and dark themes instantly without layout shift
- Preference persists via storage or cookies and rehydrates correctly on reload
- Tests cover toggle behavior, persistence mock, and compatibility with dimmed entry state

### Implementation Notes
- Reference spec Story 5
- Align tokens with standardized spacing/colors applied in T002

---

## Task T006: Strip Legacy Assets And Measure Bundle Impact
**Status:** Pending
**Dependencies:** T002, T004, T005
**Files:**
- `app/components/*`
- `public/icons/*`
- `package.json`
- `scripts/bundle-report.mjs`

### Description
Remove unused UI components, icons, and styles, update import paths, and document the bundle impact to ensure the cleanup directly reduces client payload.

### Acceptance Criteria
- Dead icons/CSS modules eliminated and verified via bundle analyzer diff vs current `main`
- Next.js build report demonstrates ≥10% bundle reduction after cleanup
- Automated check or script logs bundle metrics in CI-friendly format; tests validate script output parsing

### Implementation Notes
- Reference spec Success Metrics
- Coordinate with telemetry to ensure removed assets aren’t logged elsewhere

---

## Task T007: Update Telemetry And Analytics Hooks
**Status:** Pending
**Dependencies:** T003, T005
**Files:**
- `app/lib/analytics.ts`
- `app/chat-client.tsx`
- `tests/chat/telemetry-entry.test.tsx`

### Description
Instrument lightning entry, theme toggles, and HAL activity start/stop events so analytics can measure ease-of-connect and clutter-related support signals.

### Acceptance Criteria
- New events capture entry start timestamp, connect success latency, and theme preference selections
- Analytics payloads documented and mocked tests assert emissions without blocking UI
- Support ticket tagging guidance noted in README or AGENTS addendum

### Implementation Notes
- Supports spec Success Metrics
- Ensure telemetry stays disabled in tests unless explicitly mocked

---

## Task T008: Refresh Playwright E2E Flow
**Status:** Pending
**Dependencies:** T003, T004, T005
**Files:**
- `tests/e2e/ui-streamlining-and-cleanup.spec.ts`
- `tests/e2e/fixtures/session.ts`
- `playwright.config.ts`

### Description
Add an end-to-end scenario covering lightning entry, connect/disconnect flow, HAL indicator glow, and theme toggling to guard critical user journeys.

### Acceptance Criteria
- Playwright test runs through entry overlay, establishes session, verifies indicator glow on simulated speech, and toggles theme
- Test passes with mocked realtime session and Fast 3G throttling setup to validate timing expectations
- CI command documented to run the updated suite alongside existing tests

### Implementation Notes
- Reference spec Stories 3, 4, and 5
- Reuse existing E2E helpers where possible

---

## Task T009: Accessibility And Documentation Review
**Status:** Pending
**Dependencies:** T002, T005
**Files:**
- `tests/chat/accessibility-streamlining.test.tsx`
- `AGENTS.md`
- `README.md`

### Description
Re-run automated accessibility audits after label removal, ensure aria support is documented, and update developer docs with guidance on the streamlined UI and theme tokens.

### Acceptance Criteria
- Axe (or equivalent) tests confirm no regressions after label removal and dimming overlay
- Documentation updated with instructions for using control rail icons and theme tokens
- Accessibility checklist appended to README or AGENTS.md as required by architecture standards

### Implementation Notes
- Reference spec Stories 1 and 2
- Coordinate with design to validate HAL indicator contrast thresholds

---

## Task T010: Post-Refactor Regression Sweep
**Status:** Pending
**Dependencies:** T001, T002, T003, T004, T005, T008
**Files:**
- `tests/chat/regression-streamlining.test.tsx`
- `package.json`
- `scripts/test-matrix.mjs`

### Description
Consolidate final regression checks ensuring Jest, integration, and Playwright suites run under the streamlined UI, and capture bundle/time metrics for release notes.

### Acceptance Criteria
- Jest + Playwright pipelines run clean with updated coverage meeting ≥80% line threshold
- Snapshot updates reviewed and baselined to avoid flaky diffs
- Summary report added to release notes or internal doc capturing connect latency, bundle size, and UI survey prompts

### Implementation Notes
- Supports release readiness for the feature
- Coordinate with telemetry owners to ensure metrics hooks fire in staging

---
